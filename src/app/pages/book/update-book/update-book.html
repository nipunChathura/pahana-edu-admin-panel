<mat-toolbar color="primary" class="top-header">
  <span>Category Manage</span>
  <span class="spacer"></span>
</mat-toolbar>

<div class="toolbar-actions" style="display:flex; gap:16px; margin-top:16px;">
  <!-- Search -->
  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Search Category</mat-label>
    <input
      matInput
      [formControl]="categoryControl"
      [matAutocomplete]="autoCategory"
      placeholder="Search categories..."
    />
    <mat-autocomplete
      #autoCategory="matAutocomplete"
      (optionSelected)="onCategorySelected($event.option.value)"
    >
      <mat-option *ngFor="let category of filteredCategories$ | async" [value]="category">
        {{ category.categoryName }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <!-- Status -->
  <mat-form-field appearance="outline" class="status-field">
    <mat-label>Status</mat-label>
    <mat-select [(value)]="selectedStatus" (selectionChange)="applyStatusFilter()">
      <mat-option value="">All</mat-option>
      <mat-option value="ACTIVE">Active</mat-option>
      <mat-option value="INACTIVE">Inactive</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<form [formGroup]="bookDetailsForm" class="form-container">
  <mat-tab-group>
    <mat-tab label="Book Details">
      <div class="two-column-grid">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Category</mat-label>
          <input
            matInput
            [formControl]="categoryControl"
            [matAutocomplete]="autoCategory"
          />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width description-field">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description"></textarea>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width full-span">
          <mat-label>Author</mat-label>
          <input matInput formControlName="author" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Language</mat-label>
          <input matInput formControlName="language" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Publisher</mat-label>
          <input matInput formControlName="publisher" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Publish Date</mat-label>
          <input matInput formControlName="publishDate" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>ISBN</mat-label>
          <input matInput formControlName="isbn" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Price</mat-label>
          <input type="number" matInput formControlName="price" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Quantity</mat-label>
          <input type="number" matInput formControlName="quantity" />
        </mat-form-field>

        <div class="image-upload-container">
          <button mat-raised-button color="primary" (click)="fileInput.click()">
            Select Image
          </button>
          <input #fileInput type="file" accept="image/*" hidden (change)="onFileSelected($event)" />

          <div class="image-preview">
            <img [src]="imagePreview || defaultImage" alt="Selected Image" class="preview-img" />
            <button mat-mini-fab color="warn" class="remove-image-btn" *ngIf="imagePreview" (click)="removeImage()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="Award Details">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Award Name</mat-label>
        <input matInput formControlName="awardName" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Award Description</mat-label>
        <textarea matInput formControlName="awardDescription"></textarea>
      </mat-form-field>
    </mat-tab>
  </mat-tab-group>

  <div class="action-buttons" style="margin-top:16px;">
    <button mat-raised-button color="primary" (click)="onSave()">Save</button>
    <button mat-stroked-button color="warn" (click)="onCancel()">Cancel</button>
  </div>
</form>
